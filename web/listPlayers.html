<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<script type="text/javascript"
	      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB0pEvvdWhhnElV2CmA-9y4UniowHzJW-o&sensor=false">
	    </script>
	   <script type="text/javascript">
	      function initialize() {
	      	
	      	if(positions.length == 0) {
	      		positions[0] = new google.maps.LatLng(0., 0.);
	      	}
	      	
	        var mapOptions = {
	          center: positions[0],
	          zoom: 18,
	          mapTypeId: google.maps.MapTypeId.ROADMAP
	        };
	        var map = new google.maps.Map(document.getElementById("map_canvas"),
	            mapOptions);
	        for(i=0;i<positions.length;i++) {
	    		marker = new google.maps.Marker({
	  				position: positions[i],
	  				icon: {
	    			path: google.maps.SymbolPath.CIRCLE,
	    			scale: 4
	  				},
	  				draggable: false,
	  				map: map
				});
	        }
	      }
	      var counter = 0;
	      var positions = [];
	      
	      </script> 	
	</head>
  <body onload="initialize()">
	<h1>Listing Players</h1>
    {% for player in players %}
	<div>
    	<h2>{{ player.nickname }}</h2>
    	Last heartbeat: {{ player.lastHeartbeat }}<br>
    	Position: {{ player.position }}<br>
    	Birthdate: {{ player.birthdate }}<br>
    	<form action="/update" method="post">
			<input type="hidden" name="playerID" value="{{ player.key.urlsafe }}" />
    		<input type="text" name="lat" />
    		<input type="text" name="lon" />
    		<input type="submit" value="Update" />
    	</form>
    	<script type="text/javascript">
    		positions[counter] = new google.maps.LatLng({{ player.position.lat }}, {{ player.position.lon }});
    	 	counter = counter + 1;
    	</script>
	</div>
    {% endfor %}
    
    
    <div id="map_canvas" style="width: 400px; height: 400px">Hello world!</div>

  </body>
</html>