<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<script type="text/javascript"
	      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB0pEvvdWhhnElV2CmA-9y4UniowHzJW-o&sensor=false">
	    </script>
	   <script type="text/javascript">
	      function initialize() {
	      	
	      	if(positions.length == 0) {
	      		positions[0] = new google.maps.LatLng(0., 0.);
	      	}
	      	
	        var mapOptions = {
	          center: positions[0],
	          zoom: 18,
	          mapTypeId: google.maps.MapTypeId.ROADMAP
	        };
	        var map = new google.maps.Map(document.getElementById("map_canvas"),
	            mapOptions);
	        for(i=0;i<positions.length;i++) {
	    		marker = new google.maps.Marker({
	  				position: positions[i],
	  				icon: {
	    			path: google.maps.SymbolPath.CIRCLE,
	    			scale: 4
	  				},
	  				draggable: false,
	  				map: map
				});
	        }
	      }
	      var counter = 0;
	      var positions = [];
	      
	      </script> 	
	</head>
  <body onload="initialize()">
  	<h1>Showing {{ game.name }}</h1><i>(created: {{ game.birthdate }})</i>

        <blockquote>{{ game.description }}</blockquote>
		<br>
		<h2>List of players</h2>
	    {% for player in players %}
    	    <div>{{ player.nickname }} ({{ player.position }})</div>
        	<script type="text/javascript">
	    		positions[counter] = new google.maps.LatLng({{ player.position.lat }}, {{ player.position.lon }});
	    	 	counter = counter + 1;
    		</script>
   	 	{% endfor %}        
        {% if players.count == 0 %}
         <p>Sorry, no players in this game right now.</p>
        {% endif %}
        
        <form action="/" method="post">
        	<input type="hidden" name="deleteID" value="{{game.key.urlsafe}}" />
        	<input type="submit" value="Delete this game" />
        </form>
        
  	<hr>
    <div id="map_canvas" style="width: 400px; height: 400px">Hello world!</div>

	<h2>Create Player:</h2>
	<form action="/createPlayer" method="post">
		<input type="hidden" name="ancestor" value="{{ game.key.urlsafe }}">
		Nickname: <input type="text" name="nickname"><br>
		<input type="submit" value="Create">
	</form>    
  </body>
</html>